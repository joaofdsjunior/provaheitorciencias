<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forca de Ci√™ncias - Estilo Roblox</title>
    <style>
        /* --- GERAL E TEMA ROBLOX --- */
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@600&display=swap');

        :root {
            --roblox-blue: #00A2FF;
            --roblox-dark-blue: #0084cc;
            --roblox-grey: #A3A3A3;
            --roblox-light-grey: #E3E3E3;
            --roblox-dark-grey: #545454;
            --success-color: #00B06F;
            --danger-color: #FF4F4F;
            --background-color: #F2F2F2;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Fredoka One', cursive; background-color: var(--background-color); color: var(--roblox-dark-grey); display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 10px; }
        .container { background-color: white; padding: 20px; border-radius: 20px; width: 100%; max-width: 800px; box-shadow: 0 0 30px rgba(0, 0, 0, 0.1); border: 5px solid var(--roblox-light-grey); text-align: center; overflow: hidden; }
        h1, h2 { margin-bottom: 20px; color: var(--roblox-dark-grey); letter-spacing: 1px; }
        h1 { font-size: 2.5rem; color: var(--roblox-blue); }
        h2 { font-size: 1.4rem; font-weight: 400; min-height: 60px; display: flex; align-items: center; justify-content: center; }
        p { font-family: 'Poppins', sans-serif; font-weight: 600; font-size: 1rem; margin-bottom: 25px; }
        button { font-family: 'Fredoka One', cursive; font-size: 1.1rem; padding: 15px 20px; border-radius: 12px; border: none; cursor: pointer; transition: all 0.1s ease-in-out; margin: 5px; text-transform: uppercase; letter-spacing: 1px; }
        button:active { transform: translateY(4px); }
        .btn-primary { background-color: var(--roblox-blue); color: white; border-bottom: 6px solid var(--roblox-dark-blue); }
        .btn-primary:active { box-shadow: 0 2px 0 var(--roblox-dark-blue); }
        .btn-primary:hover { background-color: #00aeff; }
        input { font-family: 'Poppins', sans-serif; font-weight: 600; font-size: 1.1rem; padding: 15px; border-radius: 12px; border: 3px solid var(--roblox-light-grey); margin-bottom: 15px; width: 100%; }
        
        /* Telas */
        #start-screen, #game-screen, #results-screen { display: none; }
        #start-screen { display: block; }
        
        /* Estilos do Jogo da Forca */
        #hint-container { background: var(--roblox-light-grey); padding: 15px; border-radius: 15px; margin-bottom: 20px; }
        #word-container { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .letter-box { width: 40px; height: 40px; border-bottom: 4px solid var(--roblox-dark-grey); display: flex; justify-content: center; align-items: center; font-size: 2rem; }
        .letter-box.space { border: none; }
        #keyboard-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; margin-bottom: 20px; }
        .key { width: 45px; height: 45px; font-size: 1.2rem; background-color: #fff; border: 2px solid var(--roblox-light-grey); border-bottom-width: 5px; }
        .key:disabled { background-color: var(--roblox-grey); color: white; opacity: 0.5; }
        #wrong-guesses-container { margin-top: 15px; }
        #wrong-guesses-container p { margin-bottom: 10px; }
        #errors { font-size: 2rem; color: var(--danger-color); letter-spacing: 5px; }
        #game-hud { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; text-align: center; font-size: 1.2rem; margin-top: 20px; color: var(--roblox-dark-grey); background-color: var(--roblox-light-grey); padding: 10px; border-radius: 15px; }

        #award-container { margin: 20px 0; }
        #award-icon { font-size: 5rem; }
        #award-text { font-size: 1.8rem; margin-top: 10px; }
        #share-notification { color: var(--success-color); font-family: 'Poppins', sans-serif; font-weight: 600; height: 20px; }

        /* --- NOVOS ESTILOS PARA CONTROLE DE VOZ --- */
        #voice-control { margin-top: 20px; }
        #voice-btn { background-color: var(--roblox-grey); color: white; border-bottom-color: var(--roblox-dark-grey); width: 70px; height: 70px; border-radius: 50%; font-size: 2.2rem; padding: 0; }
        #voice-btn.listening { animation: pulse 1.5s infinite; }
        #voice-status { font-family: 'Poppins', sans-serif; font-weight: 600; height: 20px; margin-top: 10px; }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0, 0, 0, 0.4); }
            70% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(0, 0, 0, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0, 0, 0, 0); }
        }

        /* Otimiza√ß√£o para Desktop */
        @media (min-width: 768px) {
            .container { padding: 40px; }
            h1 { font-size: 3rem; }
            h2 { font-size: 1.6rem; min-height: 80px; }
            p { font-size: 1.1rem; }
            .letter-box { width: 50px; height: 50px; }
            .key { width: 60px; height: 60px; font-size: 1.5rem; }
            #game-hud { grid-template-columns: 1fr 1fr 1fr; font-size: 1.4rem; }
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- TELA INICIAL -->
        <div id="start-screen">
            <h1>Forca de Ci√™ncias</h1>
            <p>Adivinhe a palavra-chave para cada pergunta. Voc√™ tem 6 chances por palavra!</p>
            <input type="text" id="player-name" placeholder="Digite seu nome">
            <br>
            <button onclick="startGame()" class="btn-primary">Come√ßar</button>
        </div>

        <!-- TELA DO JOGO -->
        <div id="game-screen">
            <div id="hint-container">
                <h2 id="hint-text"></h2>
            </div>
            <div id="word-container"></div>
            <div id="keyboard-container"></div>
            <div id="voice-control">
                <button id="voice-btn">üé§</button>
                <p id="voice-status"></p>
            </div>
            <div id="wrong-guesses-container">
                <p>Erros:</p>
                <div id="errors"></div>
            </div>
            <div id="game-hud">
                <div id="score">Pontos: 0</div>
                <div id="questions-left">Perguntas: 1 / 20</div>
                <button id="skip-btn" onclick="skipQuestion()">Pular</button>
            </div>
        </div>

        <!-- TELA DE RESULTADOS -->
        <div id="results-screen">
            <h1>Fim de Jogo!</h1>
            <h2 id="final-player-name"></h2>
            <div id="award-container">
                <div id="award-icon"></div>
                <p id="award-text"></p>
            </div>
            <p id="final-correct-answers" style="font-size: 1.5rem;"></p>
            <p>Sua pontua√ß√£o final foi:</p>
            <p id="final-score" style="font-size: 4rem; color: var(--roblox-blue);"></p>
            <button onclick="shareResult()" class="btn-primary">Desafiar Amigos!</button>
            <button onclick="restartGame()" class="btn-primary">Jogar de Novo</button>
            <div id="share-notification"></div>
        </div>
    </div>

    <script>
        // --- BANCO DE PERGUNTAS PARA A FORCA ---
        const allQuestions = [
            { hint: "Principal g√°s transportado pelas hem√°cias.", answer: "OXIGENIO" },
            { hint: "Processo de troca de gases nos pulm√µes.", answer: "HEMATOSE" },
            { hint: "Principal res√≠duo nitrogenado eliminado na urina.", answer: "UREIA" },
            { hint: "C√©lulas do sangue respons√°veis pela defesa do corpo.", answer: "LEUCOCITOS" },
            { hint: "Movimento de contra√ß√£o do cora√ß√£o.", answer: "SISTOLE" },
            { hint: "Horm√¥nio que controla a reabsor√ß√£o de √°gua nos rins.", answer: "ADH" },
            { hint: "Circuito que leva sangue do cora√ß√£o para os pulm√µes e de volta.", answer: "PEQUENA CIRCULACAO" },
            { hint: "Fragmentos de c√©lulas que iniciam a coagula√ß√£o.", answer: "PLAQUETAS" },
            { hint: "Unidade funcional dos rins que filtra o sangue.", answer: "NEFRON" },
            { hint: "Membrana dupla que reveste os pulm√µes.", answer: "PLEURA" },
            { hint: "Doen√ßa causada pela falta de hemoglobina ou hem√°cias.", answer: "ANEMIA" },
            { hint: "Principal m√∫sculo da respira√ß√£o.", answer: "DIAFRAGMA" },
            { hint: "Vasos sangu√≠neos que levam sangue do cora√ß√£o para o corpo.", answer: "ARTERIAS" },
            { hint: "Parte l√≠quida do sangue.", answer: "PLASMA" },
            { hint: "Doen√ßa gen√©tica que afeta a coagula√ß√£o do sangue.", answer: "HEMOFILIA" },
            { hint: "Tipo sangu√≠neo considerado 'doador universal'.", answer: "TIPO O" },
            { hint: "Ac√∫mulo de gordura nas art√©rias.", answer: "ATEROSCLEROSE" },
            { hint: "Procedimento que filtra o sangue artificialmente.", answer: "HEMODIALISE" },
            { hint: "Canal comum aos sistemas respirat√≥rio e digest√≥rio.", answer: "FARINGE" },
            { hint: "Prote√≠nas na superf√≠cie das hem√°cias que definem o tipo sangu√≠neo.", answer: "AGLUTINOGENIOS" }
        ];

        // --- ELEMENTOS DO DOM ---
        const allScreens = { start: document.getElementById('start-screen'), game: document.getElementById('game-screen'), results: document.getElementById('results-screen') };
        const playerNameInput = document.getElementById('player-name');
        const hintText = document.getElementById('hint-text');
        const wordContainer = document.getElementById('word-container');
        const keyboardContainer = document.getElementById('keyboard-container');
        const errorsText = document.getElementById('errors');
        const scoreText = document.getElementById('score');
        const questionsLeftText = document.getElementById('questions-left');
        const finalPlayerName = document.getElementById('final-player-name');
        const finalScoreText = document.getElementById('final-score');
        const finalCorrectAnswersText = document.getElementById('final-correct-answers');
        const awardIcon = document.getElementById('award-icon');
        const awardText = document.getElementById('award-text');
        const shareNotification = document.getElementById('share-notification');
        const voiceBtn = document.getElementById('voice-btn');
        const voiceStatus = document.getElementById('voice-status');
        
        // --- VARI√ÅVEIS DO JOGO ---
        let questions = [];
        let skippedQuestions = [];
        let currentQuestion;
        let score;
        let correctAnswersCount;
        let playerName;
        let wrongGuesses;
        let revealedLetters;
        let recognition;
        const MAX_ERRORS = 6;

        // --- FUN√á√ïES DE NAVEGA√á√ÉO ---
        function showScreen(screenName) { Object.values(allScreens).forEach(screen => screen.style.display = 'none'); allScreens[screenName].style.display = 'block'; }

        // --- FUN√á√ïES DE RECONHECIMENTO DE VOZ ---
        function setupSpeechRecognition() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (SpeechRecognition) {
                recognition = new SpeechRecognition();
                recognition.lang = 'pt-BR';
                recognition.continuous = false;
                recognition.interimResults = false;

                recognition.onresult = (event) => {
                    const transcript = event.results[0][0].transcript.toUpperCase().replace(/\s/g, '');
                    voiceStatus.textContent = `Voc√™ disse: "${transcript}"`;
                    processVoiceInput(transcript);
                };

                recognition.onerror = (event) => {
                    voiceStatus.textContent = 'Erro. Tente de novo.';
                    resetVoiceButton();
                };

                recognition.onend = () => {
                    resetVoiceButton();
                };

                voiceBtn.addEventListener('click', () => {
                    if (voiceBtn.classList.contains('listening')) {
                        recognition.stop();
                    } else {
                        recognition.start();
                        voiceStatus.textContent = 'Ouvindo...';
                        voiceBtn.classList.add('listening');
                    }
                });
            } else {
                voiceBtn.style.display = 'none';
                voiceStatus.textContent = 'Reconhecimento de voz n√£o suportado.';
            }
        }

        function processVoiceInput(transcript) {
            if (transcript.length === 1) {
                handleGuess(transcript);
            } else if (transcript.length > 1) {
                handleWordGuess(transcript);
            }
        }
        
        function handleWordGuess(guessedWord) {
            if (guessedWord === currentQuestion.answer.replace(/\s/g, '')) {
                const letterBoxes = wordContainer.children;
                for (let i = 0; i < currentQuestion.answer.length; i++) {
                    if (currentQuestion.answer[i] !== ' ') {
                       letterBoxes[i].innerText = currentQuestion.answer[i];
                       revealedLetters++;
                    }
                }
                checkGameState();
            } else {
                wrongGuesses++;
                errorsText.innerText += 'X ';
                checkGameState();
            }
        }

        function resetVoiceButton() {
            voiceBtn.classList.remove('listening');
        }

        // --- FUN√á√ïES DO JOGO ---
        function shuffleArray(array) { for (let i = array.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [array[i], array[j]] = [array[j], array[i]]; } }

        function startGame() {
            playerName = playerNameInput.value || "Jogador";
            questions = [...allQuestions];
            shuffleArray(questions);
            skippedQuestions = [];
            score = 0;
            correctAnswersCount = 0;
            showScreen('game');
            nextQuestion();
        }

        function nextQuestion() {
            if (questions.length > 0) {
                currentQuestion = questions.shift();
            } else if (skippedQuestions.length > 0) {
                currentQuestion = skippedQuestions.shift();
            } else {
                showResults();
                return;
            }
            setupWord();
        }

        function setupWord() {
            wrongGuesses = 0;
            revealedLetters = 0;
            hintText.innerText = currentQuestion.hint;
            wordContainer.innerHTML = '';
            errorsText.innerText = '';
            voiceStatus.textContent = '';
            
            const totalQuestions = allQuestions.length;
            const questionsAnswered = totalQuestions - questions.length - skippedQuestions.length;
            questionsLeftText.innerText = `Pergunta ${questionsAnswered + 1} / ${totalQuestions}`;
            scoreText.innerText = `Pontos: ${score}`;

            for (const letter of currentQuestion.answer) {
                const box = document.createElement('div');
                box.classList.add('letter-box');
                if (letter === ' ') {
                    box.classList.add('space');
                    revealedLetters++;
                }
                wordContainer.appendChild(box);
            }
            createKeyboard();
        }

        function createKeyboard() {
            keyboardContainer.innerHTML = '';
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            for (const letter of alphabet) {
                const key = document.createElement('button');
                key.classList.add('key');
                key.innerText = letter;
                key.addEventListener('click', () => handleGuess(letter));
                keyboardContainer.appendChild(key);
            }
        }

        function handleGuess(guessedLetter) {
            document.querySelectorAll('.key').forEach(key => {
                if (key.innerText === guessedLetter) {
                    key.disabled = true;
                }
            });

            const answer = currentQuestion.answer;
            let letterFound = false;

            const letterBoxes = wordContainer.children;
            for (let i = 0; i < answer.length; i++) {
                if (answer[i] === guessedLetter) {
                    if (letterBoxes[i].innerText === '') { // Evita contar letras j√° reveladas
                        revealedLetters++;
                    }
                    letterBoxes[i].innerText = guessedLetter;
                    letterFound = true;
                }
            }

            if (!letterFound) {
                wrongGuesses++;
                errorsText.innerText += 'X ';
            }

            checkGameState();
        }

        function checkGameState() {
            if (revealedLetters === currentQuestion.answer.replace(/\s/g, '').length) {
                score += 10;
                correctAnswersCount++;
                setTimeout(nextQuestion, 1000);
            } else if (wrongGuesses >= MAX_ERRORS) {
                const letterBoxes = wordContainer.children;
                for (let i = 0; i < currentQuestion.answer.length; i++) {
                    letterBoxes[i].innerText = currentQuestion.answer[i];
                }
                setTimeout(nextQuestion, 2000);
            }
        }
        
        function skipQuestion() {
            skippedQuestions.push(currentQuestion);
            nextQuestion();
        }

        function showResults() {
            showScreen('results');
            finalPlayerName.innerText = playerName;
            const totalQuestions = allQuestions.length;
            const maxScore = totalQuestions * 10;
            const percentage = (correctAnswersCount / totalQuestions) * 100;

            finalScoreText.innerText = `${score} / ${maxScore}`;
            finalCorrectAnswersText.innerText = `Voc√™ acertou ${correctAnswersCount} de ${totalQuestions} perguntas.`;

            if (percentage === 100) {
                awardIcon.innerText = 'ü•á';
                awardText.innerText = 'Trof√©u Heitor de Ouro';
            } else if (percentage >= 80) {
                awardIcon.innerText = 'ü•à';
                awardText.innerText = 'Trof√©u Bibi dos C√£es de Prata';
            } else if (percentage >= 60) {
                awardIcon.innerText = 'ü•â';
                awardText.innerText = 'Trof√©u Labubu de Bronze';
            } else {
                awardIcon.innerText = 'üóëÔ∏è';
                awardText.innerText = 'Parab√©ns, seu lixo';
            }
        }

        function shareResult() {
            const textToCopy = `Fiz ${score} pontos na Forca de Ci√™ncias! Tente me superar! Pe√ßa o arquivo do jogo para o Heitor.`;
            const textArea = document.createElement('textarea');
            textArea.value = textToCopy;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);

            shareNotification.innerText = 'Mensagem copiada!';
            setTimeout(() => { shareNotification.innerText = ''; }, 2000);
        }

        function restartGame() {
            showScreen('start');
            playerNameInput.value = "";
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            showScreen('start');
            setupSpeechRecognition();
        });

    </script>
</body>
</html>

