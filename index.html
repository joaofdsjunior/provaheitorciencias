<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz de CiÃªncias - Estilo Roblox</title>
    <style>
        /* --- GERAL E TEMA ROBLOX --- */
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@600&display=swap');

        :root {
            --roblox-blue: #00A2FF;
            --roblox-dark-blue: #0084cc;
            --roblox-grey: #A3A3A3;
            --roblox-light-grey: #E3E3E3;
            --roblox-dark-grey: #545454;
            --success-color: #00B06F;
            --danger-color: #FF4F4F;
            --background-color: #F2F2F2;
            
            --btn-c1: #7BBDFF; /* Azul */
            --btn-c2: #B57BFF; /* Roxo */
            --btn-c3: #FFB37B; /* Laranja */
            --btn-c4: #7BFFD9; /* Turquesa */
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Fredoka One', cursive; background-color: var(--background-color); color: var(--roblox-dark-grey); display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 10px; }
        .container { background-color: white; padding: 20px; border-radius: 20px; width: 100%; max-width: 800px; box-shadow: 0 0 30px rgba(0, 0, 0, 0.1); border: 5px solid var(--roblox-light-grey); text-align: center; overflow: hidden; }
        .fade-out { opacity: 0; transform: translateY(-20px); transition: opacity 0.3s ease-out, transform 0.3s ease-out; }
        .fade-in { opacity: 1; transform: translateY(0); transition: opacity 0.4s ease-in, transform 0.4s ease-in; }
        h1, h2 { margin-bottom: 20px; color: var(--roblox-dark-grey); letter-spacing: 1px; }
        h1 { font-size: 2.5rem; color: var(--roblox-blue); }
        h2 { font-size: 1.4rem; font-weight: 400; min-height: 80px; display: flex; align-items: center; justify-content: center; }
        p { font-family: 'Poppins', sans-serif; font-weight: 600; font-size: 1rem; margin-bottom: 25px; }
        button { font-family: 'Fredoka One', cursive; font-size: 1.1rem; padding: 15px 20px; border-radius: 12px; border: none; cursor: pointer; transition: all 0.1s ease-in-out; margin: 5px; text-transform: uppercase; letter-spacing: 1px; }
        button:active { transform: translateY(4px); }
        .btn-primary { background-color: var(--roblox-blue); color: white; border-bottom: 6px solid var(--roblox-dark-blue); }
        .btn-primary:active { box-shadow: 0 2px 0 var(--roblox-dark-blue); }
        .btn-primary:hover { background-color: #00aeff; }
        input { font-family: 'Poppins', sans-serif; font-weight: 600; font-size: 1.1rem; padding: 15px; border-radius: 12px; border: 3px solid var(--roblox-light-grey); margin-bottom: 15px; width: 100%; }
        
        /* Telas */
        #start-screen, #quiz-screen, #results-screen, #explanation-screen { display: none; }
        #start-screen { display: block; }
        
        #quiz-screen #question-container { background: var(--roblox-light-grey); padding: 20px; margin-bottom: 25px; border-radius: 15px; }
        #quiz-screen #answers-container { display: grid; grid-template-columns: 1fr; gap: 10px; }
        #answers-container button { width: 100%; min-height: 60px; color: var(--roblox-dark-grey); border: none; border-bottom-width: 6px; border-bottom-style: solid; text-transform: none; font-family: 'Poppins', sans-serif; font-weight: 600; font-size: 0.9rem; padding: 10px; }
        #answers-container button:hover { filter: brightness(1.05); }
        #answers-container button:active { border-bottom-width: 2px; }
        .btn-color-1 { background-color: var(--btn-c1); border-color: #689fd9; }
        .btn-color-2 { background-color: var(--btn-c2); border-color: #9c68d9; }
        .btn-color-3 { background-color: var(--btn-c3); border-color: #d99668; }
        .btn-color-4 { background-color: var(--btn-c4); border-color: #68d9b8; }
        #quiz-screen #hud { display: grid; grid-template-columns: 1fr; gap: 10px; text-align: center; font-size: 1.2rem; margin-top: 20px; color: var(--roblox-dark-grey); background-color: var(--roblox-light-grey); padding: 10px; border-radius: 15px; }
        .correct { background-color: var(--success-color) !important; color: white !important; border-color: #008a58 !important; }
        .incorrect { background-color: var(--danger-color) !important; color: white !important; border-color: #cc3f3f !important; opacity: 0.8; }
        
        #explanation-screen { min-height: 350px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        #explanation-header { font-size: 2rem; margin-bottom: 15px; }
        #explanation-text { font-family: 'Poppins', sans-serif; font-size: 1.1rem; font-weight: 600; max-width: 90%; margin-bottom: 25px; }
        #final-score { font-size: 3rem !important; }

        #award-container { margin: 20px 0; }
        #award-icon { font-size: 5rem; }
        #award-text { font-size: 1.8rem; margin-top: 10px; }
        #share-notification { color: var(--success-color); font-family: 'Poppins', sans-serif; font-weight: 600; height: 20px; }

        /* --- NOVOS ESTILOS PARA CONTROLE DE VOZ --- */
        #voice-control { margin-top: 20px; }
        #voice-btn { background-color: var(--roblox-grey); color: white; border-bottom-color: var(--roblox-dark-grey); width: 80px; height: 80px; border-radius: 50%; font-size: 2.5rem; padding: 0; }
        #voice-btn.listening { animation: pulse 1.5s infinite; }
        #voice-status { font-family: 'Poppins', sans-serif; font-weight: 600; height: 20px; margin-top: 10px; }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0, 0, 0, 0.4); }
            70% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(0, 0, 0, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0, 0, 0, 0); }
        }

        /* --- OTIMIZAÃ‡ÃƒO PARA DESKTOP (TELAS MAIORES) --- */
        @media (min-width: 768px) {
            .container { padding: 40px; }
            h1 { font-size: 3rem; }
            h2 { font-size: 1.6rem; min-height: 100px; }
            p { font-size: 1.1rem; }
            input { width: 90%; }
            #quiz-screen #answers-container { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; }
            #answers-container button { min-height: 70px; font-size: 1rem; }
            #quiz-screen #hud { grid-template-columns: 1fr 1fr 1fr; font-size: 1.4rem; margin-top: 30px; }
            #explanation-screen { min-height: 400px; }
            #explanation-header { font-size: 2.5rem; }
            #explanation-text { font-size: 1.2rem; }
            #final-score { font-size: 4rem !important; }
        }

    </style>
</head>
<body>

    <div class="container">
        <!-- TELA INICIAL -->
        <div id="start-screen">
            <h1>Quiz de CiÃªncias</h1>
            <p>Teste seus conhecimentos! Cada pergunta vale 10 pontos.</p>
            <input type="text" id="player-name" placeholder="Digite seu nome">
            <br>
            <button onclick="startGame()" class="btn-primary">Jogar</button>
        </div>

        <!-- TELA DO QUIZ -->
        <div id="quiz-screen">
            <div id="question-container"><h2 id="question-text"></h2></div>
            <div id="answers-container"></div>
            <div id="voice-control">
                <button id="voice-btn">ðŸŽ¤</button>
                <p id="voice-status"></p>
            </div>
            <div id="hud">
                <div id="progress">Pergunta 1 / 40</div>
                <div id="score">Pontos: 0</div>
                <div id="correct-answers">Acertos: 0</div>
            </div>
        </div>
        
        <!-- TELA DE EXPLICAÃ‡ÃƒO -->
        <div id="explanation-screen">
            <h2 id="explanation-header"></h2>
            <p id="explanation-text"></p>
            <button onclick="showNextQuestion()" class="btn-primary">PrÃ³xima Pergunta</button>
        </div>

        <!-- TELA DE RESULTADOS -->
        <div id="results-screen">
            <h1>Fim de Jogo!</h1>
            <h2 id="final-player-name"></h2>
            <div id="award-container">
                <div id="award-icon"></div>
                <p id="award-text"></p>
            </div>
            <p id="final-correct-answers" style="font-size: 1.5rem;"></p>
            <p>Sua pontuaÃ§Ã£o final foi:</p>
            <p id="final-score" style="font-size: 4rem; color: var(--roblox-blue);"></p>
            <button onclick="shareResult()" class="btn-primary">Desafiar Amigos!</button>
            <button onclick="restartGame()" class="btn-primary">Jogar de Novo</button>
            <div id="share-notification"></div>
        </div>
    </div>

    <script>
        // --- BANCO DE PERGUNTAS E MENSAGENS---
        const allQuestions = [
            { question: "Um atleta de maratona, durante uma corrida, aumenta intensamente sua frequÃªncia respiratÃ³ria e cardÃ­aca. Qual a principal razÃ£o fisiolÃ³gica para essa resposta do corpo ao exercÃ­cio?", answers: [{ text: "Para aumentar a produÃ§Ã£o de suor e resfriar o corpo mais rapidamente.", correct: false }, { text: "Para fornecer mais oxigÃªnio e nutrientes aos mÃºsculos, que estÃ£o consumindo mais energia.", correct: true }, { text: "Para diminuir a pressÃ£o arterial, que sobe perigosamente durante o esforÃ§o fÃ­sico.", correct: false }, { text: "Para eliminar o excesso de Ã¡gua do sangue atravÃ©s da respiraÃ§Ã£o e da transpiraÃ§Ã£o.", correct: false }], explanation: "Durante o exercÃ­cio, os mÃºsculos precisam de mais energia (ATP), cuja produÃ§Ã£o depende de oxigÃªnio. O corpo acelera a respiraÃ§Ã£o para captar mais O2 e os batimentos cardÃ­acos para transportÃ¡-lo mais rÃ¡pido atÃ© os mÃºsculos." },
            { question: "ApÃ³s uma refeiÃ§Ã£o rica em proteÃ­nas, o metabolismo celular produz uma grande quantidade de ureia, que Ã© tÃ³xica. Qual Ã© o trajeto correto que a ureia faz desde sua produÃ§Ã£o atÃ© ser eliminada do corpo?", answers: [{ text: "Ã‰ produzida nos rins, vai para o fÃ­gado para ser processada e Ã© eliminada nas fezes.", correct: false }, { text: "Ã‰ produzida no fÃ­gado a partir da amÃ´nia, cai no sangue, Ã© filtrada pelos rins e eliminada na urina.", correct: true }, { text: "Ã‰ produzida nos mÃºsculos, transportada pelo sangue e eliminada diretamente pela pele atravÃ©s do suor.", correct: false }, { text: "Ã‰ produzida no pÃ¢ncreas, segue para o intestino e Ã© eliminada junto com os restos de alimentos.", correct: false }], explanation: "O fÃ­gado converte a amÃ´nia (altamente tÃ³xica) em ureia (menos tÃ³xica). A ureia Ã© entÃ£o liberada no sangue, e os rins sÃ£o os Ã³rgÃ£os responsÃ¡veis por filtrar o sangue e remover essa ureia, eliminando-a na urina." },
            { question: "Um paciente chega ao hospital e precisa de uma transfusÃ£o de sangue de emergÃªncia. O sangue dele Ã© do tipo A+. Considerando os antÃ­genos e anticorpos, qual tipo sanguÃ­neo ele NÃƒO PODE receber de forma alguma?", answers: [{ text: "O+, pois ambos sÃ£o Rh positivo e o corpo nÃ£o reagiria.", correct: false }, { text: "A-, pois nÃ£o possui o antÃ­geno Rh e Ã© compatÃ­vel com o sistema ABO.", correct: false }, { text: "B+, pois o plasma do paciente A+ contÃ©m anticorpos Anti-B que atacariam as hemÃ¡cias do doador.", correct: true }, { text: "O-, pois, por ser doador universal, Ã© seguro para qualquer tipo sanguÃ­neo.", correct: false }], explanation: "Uma pessoa do tipo A+ possui antÃ­genos A e Rh em suas hemÃ¡cias e anticorpos Anti-B no plasma. Se receber sangue B+, seus anticorpos Anti-B atacarÃ£o as hemÃ¡cias do doador, causando uma reaÃ§Ã£o perigosa de aglutinaÃ§Ã£o." },
            { question: "Para que o ar entre nos pulmÃµes, Ã© necessÃ¡rio que o volume da caixa torÃ¡cica aumente. Qual movimento coordenado dos mÃºsculos respiratÃ³rios permite que a inspiraÃ§Ã£o ocorra?", answers: [{ text: "O diafragma relaxa e sobe, enquanto os mÃºsculos intercostais se contraem para expandir o tÃ³rax.", correct: false }, { text: "O diafragma contrai e desce, e os mÃºsculos intercostais levantam as costelas, aumentando o espaÃ§o.", correct: true }, { text: "Apenas o diafragma contrai e desce, sendo o Ãºnico mÃºsculo ativo na inspiraÃ§Ã£o tranquila.", correct: false }, { text: "O diafragma e os mÃºsculos intercostais relaxam simultaneamente, permitindo a entrada passiva do ar.", correct: false }], explanation: "A inspiraÃ§Ã£o Ã© um processo ativo. A contraÃ§Ã£o do diafragma (que o move para baixo) e a contraÃ§Ã£o dos mÃºsculos intercostais (que elevam as costelas) aumentam o volume da caixa torÃ¡cica, diminuindo a pressÃ£o interna e forÃ§ando a entrada do ar." },
            { question: "Durante o processo de formaÃ§Ã£o da urina no nÃ©fron, diversas substÃ¢ncias sÃ£o filtradas do sangue, mas algumas que sÃ£o Ãºteis ao corpo precisam ser devolvidas Ã  circulaÃ§Ã£o. Como se chama esse processo de 'devoluÃ§Ã£o' e qual substÃ¢ncia Ã© um exemplo disso?", answers: [{ text: "Chama-se secreÃ§Ã£o, e um exemplo Ã© a ureia, que Ã© devolvida ao sangue.", correct: false }, { text: "Chama-se filtraÃ§Ã£o, e um exemplo sÃ£o as proteÃ­nas, que sÃ£o devolvidas.", correct: false }, { text: "Chama-se reabsorÃ§Ã£o, e um exemplo Ã© a glicose, que Ã© totalmente reabsorvida em uma pessoa saudÃ¡vel.", correct: true }, { text: "Chama-se excreÃ§Ã£o, e um exemplo Ã© a Ã¡gua, que Ã© totalmente devolvida ao sangue.", correct: false }], explanation: "ApÃ³s a filtraÃ§Ã£o inicial, o processo de reabsorÃ§Ã£o tubular recupera substÃ¢ncias essenciais. Em um indivÃ­duo saudÃ¡vel, 100% da glicose filtrada Ã© reabsorvida de volta para o sangue, pois Ã© uma fonte de energia valiosa." },
            { question: "Um indivÃ­duo com anemia ferropriva sente muito cansaÃ§o e falta de ar ao fazer esforÃ§os. Qual a conexÃ£o direta entre a falta de ferro e esses sintomas?", answers: [{ text: "O ferro Ã© essencial para a coagulaÃ§Ã£o, e sua falta causa pequenos sangramentos internos.", correct: false }, { text: "A falta de ferro afeta os leucÃ³citos, diminuindo a imunidade e causando fraqueza.", correct: false }, { text: "O ferro Ã© um componente central da hemoglobina, que transporta oxigÃªnio. Sem ferro, hÃ¡ menos transporte de O2 para as cÃ©lulas produzirem energia.", correct: true }, { text: "O ferro Ã© necessÃ¡rio para a contraÃ§Ã£o do diafragma, e sua falta dificulta a respiraÃ§Ã£o.", correct: false }], explanation: "A hemoglobina, proteÃ­na que transporta oxigÃªnio dentro das hemÃ¡cias, depende do ferro para ser formada. A falta de ferro (anemia ferropriva) leva a uma menor capacidade de transporte de oxigÃªnio pelo sangue, resultando em cansaÃ§o por falta de energia nas cÃ©lulas." },
            { question: "Se uma pessoa prende a respiraÃ§Ã£o por muito tempo, o que acontece com a concentraÃ§Ã£o de gases no sangue e qual a consequÃªncia imediata disso no cÃ©rebro?", answers: [{ text: "A concentraÃ§Ã£o de O2 aumenta e a de CO2 diminui, causando euforia.", correct: false }, { text: "A concentraÃ§Ã£o de CO2 aumenta, o que torna o sangue mais Ã¡cido e estimula o centro respiratÃ³rio no cÃ©rebro a forÃ§ar a respiraÃ§Ã£o.", correct: true }, { text: "A concentraÃ§Ã£o de O2 e CO2 se estabiliza, permitindo prender a respiraÃ§Ã£o por vÃ¡rios minutos sem consequÃªncias.", correct: false }, { text: "A concentraÃ§Ã£o de CO2 diminui, o que relaxa o cÃ©rebro e causa sonolÃªncia.", correct: false }], explanation: "Ao prender a respiraÃ§Ã£o, o CO2 produzido pelas cÃ©lulas se acumula no sangue. Esse aumento de CO2 Ã© o principal estÃ­mulo para o centro respiratÃ³rio no bulbo (parte do cÃ©rebro), que dispara um comando involuntÃ¡rio para os mÃºsculos respiratÃ³rios contraÃ­rem, forÃ§ando a respiraÃ§Ã£o." },
            { question: "O coraÃ§Ã£o humano possui quatro cÃ¢maras que trabalham em sincronia. Qual Ã© a sequÃªncia correta do fluxo de sangue venoso (pobre em O2) ao entrar no coraÃ§Ã£o?", answers: [{ text: "Entra no Ã¡trio esquerdo, passa para o ventrÃ­culo esquerdo e Ã© bombeado para os pulmÃµes.", correct: false }, { text: "Entra no Ã¡trio direito, passa para o ventrÃ­culo direito e Ã© bombeado para os pulmÃµes.", correct: true }, { text: "Entra no ventrÃ­culo direito, passa para o Ã¡trio direito e Ã© bombeado para o corpo.", correct: false }, { text: "Entra no Ã¡trio direito, passa para o Ã¡trio esquerdo e depois para os ventrÃ­culos.", correct: false }], explanation: "O sangue venoso, vindo do corpo, entra no coraÃ§Ã£o pelo Ã¡trio direito. De lÃ¡, passa pela valva tricÃºspide para o ventrÃ­culo direito, que o bombeia para os pulmÃµes atravÃ©s da artÃ©ria pulmonar para ser oxigenado." },
            { question: "Um paciente com insuficiÃªncia renal crÃ´nica precisa fazer hemodiÃ¡lise. O que a mÃ¡quina de hemodiÃ¡lise faz que o corpo do paciente nÃ£o consegue mais fazer eficientemente?", answers: [{ text: "Produz hormÃ´nios para controlar a pressÃ£o arterial e a produÃ§Ã£o de hemÃ¡cias.", correct: false }, { text: "Transporta oxigÃªnio para as cÃ©lulas do corpo, substituindo a funÃ§Ã£o do sangue.", correct: false }, { text: "Filtra o sangue para remover o excesso de Ã¡gua, sais e resÃ­duos tÃ³xicos como a ureia.", correct: true }, { text: "Bombeia o sangue pelo corpo, substituindo a funÃ§Ã£o do coraÃ§Ã£o.", correct: false }], explanation: "A hemodiÃ¡lise simula a funÃ§Ã£o principal dos rins: a filtraÃ§Ã£o do sangue. A mÃ¡quina remove as impurezas e o excesso de lÃ­quidos que se acumulam no corpo quando os rins falham." },
            { question: "A aterosclerose, o acÃºmulo de placas de gordura nas artÃ©rias, Ã© um fator de risco para o infarto. Como esse processo pode levar a um ataque cardÃ­aco?", answers: [{ text: "As placas de gordura se desprendem e viajam atÃ© os pulmÃµes, causando uma embolia pulmonar.", correct: false }, { text: "O acÃºmulo de gordura aumenta a produÃ§Ã£o de glÃ³bulos brancos, que atacam o coraÃ§Ã£o.", correct: false }, { text: "A placa de gordura pode romper, formando um coÃ¡gulo que bloqueia uma artÃ©ria coronÃ¡ria, interrompendo o fluxo de sangue para o mÃºsculo cardÃ­aco.", correct: true }, { text: "A gordura endurece as veias, dificultando o retorno do sangue para o coraÃ§Ã£o.", correct: false }], explanation: "O infarto ocorre quando o fluxo de sangue para uma parte do coraÃ§Ã£o Ã© bloqueado. Na aterosclerose, uma placa de gordura em uma artÃ©ria coronÃ¡ria (que irriga o coraÃ§Ã£o) pode se romper, ativando a coagulaÃ§Ã£o e formando um trombo (coÃ¡gulo) que obstrui a passagem de sangue." },
            { question: "Qual o nome da estrutura que impede o alimento de entrar na traqueia?", answers: [{ text: "Faringe", correct: false }, { text: "Diafragma", correct: false }, { text: "Epiglote", correct: true }, { text: "Glote", correct: false }], explanation: "A epiglote Ã© uma cartilagem que funciona como uma 'porta', fechando a entrada da laringe quando engolimos para que o alimento vÃ¡ para o esÃ´fago." },
            { question: "A hemofilia Ã© uma condiÃ§Ã£o que afeta qual processo do sangue?", answers: [{ text: "Transporte de oxigÃªnio", correct: false }, { text: "CoagulaÃ§Ã£o", correct: true }, { text: "Defesa contra infecÃ§Ãµes", correct: false }, { text: "ProduÃ§Ã£o de anticorpos", correct: false }], explanation: "A hemofilia Ã© uma doenÃ§a genÃ©tica que dificulta a coagulaÃ§Ã£o do sangue, podendo causar hemorragias graves." },
            { question: "Na pressÃ£o arterial 120/80 mmHg, o que o nÃºmero 120 representa?", answers: [{ text: "PressÃ£o da diÃ¡stole", correct: false }, { text: "PressÃ£o dos capilares", correct: false }, { text: "PressÃ£o da sÃ­stole", correct: true }, { text: "FrequÃªncia cardÃ­aca", correct: false }], explanation: "O nÃºmero maior (120) representa a pressÃ£o sistÃ³lica, a forÃ§a mÃ¡xima do sangue nas artÃ©rias quando o coraÃ§Ã£o se contrai." },
            { question: "Qual o nome da doenÃ§a causada pela incompatibilidade do Fator Rh entre mÃ£e e feto?", answers: [{ text: "Anemia", correct: false }, { text: "Hemofilia", correct: false }, { text: "Trombose", correct: false }, { text: "Eritroblastose Fetal", correct: true }], explanation: "A Eritroblastose Fetal ocorre quando uma mÃ£e Rh- gera anticorpos contra as hemÃ¡cias de um feto Rh+, o que pode ser perigoso em uma segunda gestaÃ§Ã£o." },
            { question: "Por que a urina de uma pessoa saudÃ¡vel nÃ£o deve conter glicose?", answers: [{ text: "Porque a glicose Ã© tÃ³xica", correct: false }, { text: "Ã‰ totalmente reabsorvida nos rins", correct: true }, { text: "NÃ£o Ã© filtrada pelos rins", correct: false }, { text: "Porque a glicose evapora", correct: false }], explanation: "Toda a glicose que Ã© filtrada nos rins Ã© reabsorvida de volta para o sangue, pois Ã© uma fonte de energia importante. Sua presenÃ§a na urina pode indicar diabetes." },
            { question: "Qual a funÃ§Ã£o das vÃ¡lvulas localizadas no coraÃ§Ã£o e nas veias?", answers: [{ text: "Acelerar o fluxo sanguÃ­neo", correct: false }, { text: "Impedir o refluxo do sangue", correct: true }, { text: "Filtrar o sangue", correct: false }, { text: "Produzir hemÃ¡cias", correct: false }], explanation: "As vÃ¡lvulas funcionam como portÃµes de sentido Ãºnico, garantindo que o sangue flua sempre na direÃ§Ã£o correta e nÃ£o retorne." },
            { question: "O que Ã© a morte encefÃ¡lica, condiÃ§Ã£o para a doaÃ§Ã£o de Ã³rgÃ£os?", answers: [{ text: "CoraÃ§Ã£o para de bater", correct: false }, { text: "Perda irreversÃ­vel das funÃ§Ãµes do cÃ©rebro", correct: true }, { text: "Um coma profundo", correct: false }, { text: "PulmÃµes param de funcionar", correct: false }], explanation: "A morte encefÃ¡lica Ã© a parada total e irreversÃ­vel do cÃ©rebro. Ã‰ o critÃ©rio legal para a doaÃ§Ã£o de Ã³rgÃ£os, mesmo que o coraÃ§Ã£o ainda bata com ajuda de aparelhos." },
            { question: "Qual estrutura pertence tanto ao sistema respiratÃ³rio quanto ao digestÃ³rio?", answers: [{ text: "Laringe", correct: false }, { text: "EsÃ´fago", correct: false }, { text: "Faringe", correct: true }, { text: "BrÃ´nquios", correct: false }], explanation: "A faringe Ã© um canal comum por onde passam tanto o ar (para a laringe) quanto o alimento (para o esÃ´fago)." },
            { question: "Por que pessoas que vivem em grandes altitudes tÃªm mais hemÃ¡cias?", answers: [{ text: "Porque o ar Ã© mais quente", correct: false }, { text: "Para adaptar Ã  menor quantidade de oxigÃªnio", correct: true }, { text: "Porque comem mais ferro", correct: false }, { text: "Ã‰ coincidÃªncia genÃ©tica", correct: false }], explanation: "Em altitudes elevadas, o ar Ã© rarefeito (menos oxigÃªnio). O corpo se adapta produzindo mais hemÃ¡cias para otimizar a captaÃ§Ã£o do pouco oxigÃªnio disponÃ­vel." },
            { question: "O que Ã© a aterosclerose?", answers: [{ text: "InfecÃ§Ã£o nos pulmÃµes", correct: false }, { text: "Arritmia cardÃ­aca", correct: false }, { text: "Endurecimento das artÃ©rias por gordura", correct: true }, { text: "DoenÃ§a nos rins", correct: false }], explanation: "A aterosclerose Ã© o acÃºmulo de placas de gordura nas paredes das artÃ©rias, o que as endurece e dificulta a passagem do sangue, podendo causar infartos e AVCs." },
            { question: "O que acontece com o diafragma durante a inspiraÃ§Ã£o?", answers: [{ text: "Ele relaxa e sobe", correct: false }, { text: "Ele contrai e desce", correct: true }, { text: "Ele nÃ£o se move", correct: false }, { text: "Ele se move para os lados", correct: false }], explanation: "Na inspiraÃ§Ã£o, o diafragma se contrai e desce, aumentando o volume da caixa torÃ¡cica e permitindo que o ar entre nos pulmÃµes." },
            { question: "Qual o nome do lÃ­quido amarelado do sangue, composto principalmente por Ã¡gua?", answers: [{ text: "Linfa", correct: false }, { text: "Soro", correct: false }, { text: "Plasma", correct: true }, { text: "Hemoglobina", correct: false }], explanation: "O plasma Ã© a parte lÃ­quida do sangue (cerca de 55% do volume total) e Ã© responsÃ¡vel por transportar cÃ©lulas, nutrientes e outras substÃ¢ncias." },
            { question: "O que acontece com a produÃ§Ã£o de urina se uma pessoa bebe muito Ã¡lcool?", answers: [{ text: "Diminui, pois o Ã¡lcool inibe o ADH", correct: false }, { text: "Aumenta, pois o Ã¡lcool inibe o ADH", correct: true }, { text: "NÃ£o se altera", correct: false }, { text: "A urina fica mais escura", correct: false }], explanation: "O Ã¡lcool inibe o hormÃ´nio ADH, fazendo com que os rins reabsorvam menos Ã¡gua. Isso aumenta o volume de urina e pode levar Ã  desidrataÃ§Ã£o." },
            { question: "Qual o nome do processo de respiraÃ§Ã£o que ocorre dentro das cÃ©lulas?", answers: [{ text: "Hematose", correct: false }, { text: "VentilaÃ§Ã£o Pulmonar", correct: false }, { text: "RespiraÃ§Ã£o Celular", correct: true }, { text: "Fagocitose", correct: false }], explanation: "A RespiraÃ§Ã£o Celular acontece nas mitocÃ´ndrias, onde a cÃ©lula usa oxigÃªnio para quebrar a glicose e produzir energia (ATP)." },
            { question: "Um exame com baixo nÃºmero de plaquetas indica um risco maior de:", answers: [{ text: "InfecÃ§Ãµes", correct: false }, { text: "Anemia", correct: false }, { text: "Hemorragias", correct: true }, { text: "Alergias", correct: false }], explanation: "As plaquetas sÃ£o essenciais para a coagulaÃ§Ã£o. Um nÃºmero baixo delas significa que o corpo tem dificuldade em estancar sangramentos." },
            { question: "Qual vaso sanguÃ­neo geralmente tem a parede mais espessa e elÃ¡stica?", answers: [{ text: "Veia", correct: false }, { text: "ArtÃ©ria", correct: true }, { text: "Capilar", correct: false }, { text: "VÃªnula", correct: false }], explanation: "As artÃ©rias precisam ter paredes grossas e elÃ¡sticas para suportar a alta pressÃ£o do sangue bombeado pelo coraÃ§Ã£o." },
            { question: "Onde ficam os aglutinogÃªnios, que definem o tipo sanguÃ­neo?", answers: [{ text: "No plasma", correct: false }, { text: "Nos leucÃ³citos", correct: false }, { text: "Nas hemÃ¡cias", correct: true }, { text: "Nas plaquetas", correct: false }], explanation: "Os aglutinogÃªnios (antÃ­genos A e B) sÃ£o proteÃ­nas localizadas na superfÃ­cie das hemÃ¡cias, funcionando como uma 'identidade' da cÃ©lula." },
            { question: "O que Ã© um infarto do miocÃ¡rdio?", answers: [{ text: "Uma arritmia grave", correct: false }, { text: "PressÃ£o alta", correct: false }, { text: "Morte de parte do mÃºsculo cardÃ­aco", correct: true }, { text: "InflamaÃ§Ã£o do coraÃ§Ã£o", correct: false }], explanation: "O infarto ocorre quando uma artÃ©ria do coraÃ§Ã£o (coronÃ¡ria) Ã© bloqueada, impedindo a chegada de oxigÃªnio e causando a morte de parte do mÃºsculo cardÃ­aco." },
            { question: "Qual o nome do 'marca-passo natural' do coraÃ§Ã£o?", answers: [{ text: "NÃ³ atrioventricular", correct: false }, { text: "MiocÃ¡rdio", correct: false }, { text: "VÃ¡lvula mitral", correct: false }, { text: "NÃ³ sinoatrial", correct: true }], explanation: "O nÃ³ sinoatrial Ã© um conjunto de cÃ©lulas que gera os impulsos elÃ©tricos que coordenam os batimentos do coraÃ§Ã£o." },
            { question: "Qual o tratamento para uma pessoa cujos rins pararam de funcionar?", answers: [{ text: "TransfusÃ£o de sangue", correct: false }, { text: "HemodiÃ¡lise", correct: true }, { text: "Quimioterapia", correct: false }, { text: "Cateterismo", correct: false }], explanation: "A hemodiÃ¡lise Ã© um procedimento que filtra o sangue artificialmente, fazendo o trabalho que os rins doentes nÃ£o conseguem mais fazer." },
            { question: "Por que nÃ£o se deve beber Ã¡gua do mar?", answers: [{ text: "ContÃ©m muitas bactÃ©rias", correct: false }, { text: "Ã‰ muito gelada", correct: false }, { text: "O excesso de sal causa desidrataÃ§Ã£o", correct: true }, { text: "NÃ£o tem nutrientes", correct: false }], explanation: "A Ã¡gua do mar Ã© tÃ£o salgada que, para eliminÃ¡-la, nosso corpo precisa usar mais Ã¡gua do que a que foi ingerida, causando desidrataÃ§Ã£o." },
            { question: "O que sÃ£o os cÃ­lios presentes na traqueia?", answers: [{ text: "Estruturas que produzem som", correct: false }, { text: "Filtram o ar, empurrando o muco", correct: true }, { text: "Realizam a troca gasosa", correct: false }, { text: "SÃ£o responsÃ¡veis pelo olfato", correct: false }], explanation: "Os cÃ­lios da traqueia se movem constantemente para empurrar o muco com impurezas (poeira, bactÃ©rias) para fora das vias respiratÃ³rias." },
            { question: "Qual o nome do procedimento que remove pedras nos rins com ondas de choque?", answers: [{ text: "Endoscopia", correct: false }, { text: "Cateterismo", correct: false }, { text: "Litotripsia", correct: true }, { text: "BiÃ³psia", correct: false }], explanation: "A litotripsia usa ondas de choque de alta energia para quebrar os cÃ¡lculos renais em pedaÃ§os menores, que podem ser eliminados pela urina." },
            { question: "Uma pessoa do tipo AB+ pode receber sangue de quem?", answers: [{ text: "Apenas de AB+", correct: false }, { text: "Apenas de O-", correct: false }, { text: "De todos os tipos (Receptor Universal)", correct: true }, { text: "Apenas de tipos com Rh+", correct: false }], explanation: "O sangue AB+ Ã© o receptor universal porque possui os antÃ­genos A, B e Rh, entÃ£o nÃ£o produz anticorpos contra nenhum tipo sanguÃ­neo." },
            { question: "O que Ã© a pleura?", answers: [{ text: "O mÃºsculo da respiraÃ§Ã£o", correct: false }, { text: "A membrana que reveste os pulmÃµes", correct: true }, { text: "Onde o sangue Ã© feito", correct: false }, { text: "Um osso da caixa torÃ¡cica", correct: false }], explanation: "A pleura Ã© uma membrana dupla que reveste os pulmÃµes, permitindo que eles deslizem suavemente dentro da caixa torÃ¡cica durante a respiraÃ§Ã£o." },
            { question: "Qual o principal risco da hipertensÃ£o (pressÃ£o alta)?", answers: [{ text: "CÃ¡ries", correct: false }, { text: "Diabetes", correct: false }, { text: "AVC e infarto", correct: true }, { text: "Gripe", correct: false }], explanation: "A pressÃ£o alta forÃ§a o coraÃ§Ã£o a trabalhar mais e danifica as paredes das artÃ©rias, aumentando muito o risco de Acidente Vascular Cerebral (AVC) e infarto." },
            { question: "O sangue venoso Ã© rico em qual gÃ¡s?", answers: [{ text: "OxigÃªnio", correct: false }, { text: "GÃ¡s CarbÃ´nico (CO2)", correct: true }, { text: "NitrogÃªnio", correct: false }, { text: "HÃ©lio", correct: false }], explanation: "O sangue venoso Ã© aquele que estÃ¡ voltando dos tecidos do corpo, trazendo o gÃ¡s carbÃ´nico produzido pelas cÃ©lulas para ser eliminado nos pulmÃµes." },
            { question: "Qual o nome da unidade filtradora dos rins?", answers: [{ text: "AlvÃ©olo", correct: false }, { text: "NeurÃ´nio", correct: false }, { text: "NÃ©fron", correct: true }, { text: "CÃ¡psula", correct: false }], explanation: "Cada rim possui cerca de 1 milhÃ£o de nÃ©frons, que sÃ£o as estruturas microscÃ³picas responsÃ¡veis por filtrar o sangue e formar a urina." },
            { question: "Qual o tempo mÃ¡ximo de doaÃ§Ã£o de sangue para homens por ano?", answers: [{ text: "12 vezes", correct: false }, { text: "2 vezes", correct: false }, { text: "6 vezes", correct: false }, { text: "4 vezes", correct:true }], explanation: "Homens podem doar sangue a cada 2 meses, com um limite de 4 doaÃ§Ãµes por ano, para garantir a recuperaÃ§Ã£o completa do corpo." },
            { question: "O que Ã© leucemia?", answers: [{ text: "Falta de hemÃ¡cias", correct: false }, { text: "CÃ¢ncer nas cÃ©lulas de defesa (leucÃ³citos)", correct: true }, { text: "Excesso de plaquetas", correct: false }, { text: "Falta de plasma", correct: false }], explanation: "A leucemia Ã© um tipo de cÃ¢ncer que afeta a medula Ã³ssea, causando a produÃ§Ã£o descontrolada de glÃ³bulos brancos (leucÃ³citos) anormais." }
        ];
        const correctFeedbacks = [ "Isso mesmo!", "Mandou bem!", "Perfeito!", "Acertou em cheio!", "Ã‰ exatamente isso!" ];
        const incorrectFeedbacks = [ "Na trave!", "Quase lÃ¡...", "NÃ£o foi dessa vez.", "Opa!", "Essa pegou, hein?" ];

        // --- ELEMENTOS DO DOM ---
        const allScreens = { start: document.getElementById('start-screen'), quiz: document.getElementById('quiz-screen'), results: document.getElementById('results-screen'), explanation: document.getElementById('explanation-screen') };
        const playerNameInput = document.getElementById('player-name');
        const questionText = document.getElementById('question-text');
        const answersContainer = document.getElementById('answers-container');
        const progressText = document.getElementById('progress');
        const scoreText = document.getElementById('score');
        const correctAnswersText = document.getElementById('correct-answers');
        const explanationHeader = document.getElementById('explanation-header');
        const explanationText = document.getElementById('explanation-text');
        const finalPlayerName = document.getElementById('final-player-name');
        const finalScoreText = document.getElementById('final-score');
        const finalCorrectAnswersText = document.getElementById('final-correct-answers');
        const awardIcon = document.getElementById('award-icon');
        const awardText = document.getElementById('award-text');
        const shareNotification = document.getElementById('share-notification');
        const voiceBtn = document.getElementById('voice-btn');
        const voiceStatus = document.getElementById('voice-status');
        
        // --- VARIÃVEIS DO JOGO ---
        let questions = [];
        let currentQuestionIndex;
        let score;
        let correctAnswersCount;
        let playerName;
        let recognition;

        // --- FUNÃ‡Ã•ES DE NAVEGAÃ‡ÃƒO ---
        function showScreen(screenName) { Object.values(allScreens).forEach(screen => screen.style.display = 'none'); allScreens[screenName].style.display = 'block'; allScreens[screenName].classList.add('fade-in'); }

        // --- FUNÃ‡Ã•ES DE RECONHECIMENTO DE VOZ ---
        function setupSpeechRecognition() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (SpeechRecognition) {
                recognition = new SpeechRecognition();
                recognition.lang = 'pt-BR';
                recognition.continuous = false;
                recognition.interimResults = false;

                recognition.onresult = (event) => {
                    const transcript = event.results[0][0].transcript.toLowerCase().trim();
                    voiceStatus.textContent = `VocÃª disse: "${transcript}"`;
                    checkVoiceAnswer(transcript);
                };

                recognition.onerror = (event) => {
                    voiceStatus.textContent = 'Erro no reconhecimento. Tente de novo.';
                    resetVoiceButton();
                };

                recognition.onend = () => {
                    resetVoiceButton();
                };

                voiceBtn.addEventListener('click', () => {
                    if (voiceBtn.classList.contains('listening')) {
                        recognition.stop();
                    } else {
                        recognition.start();
                        voiceStatus.textContent = 'Ouvindo...';
                        voiceBtn.classList.add('listening');
                    }
                });
            } else {
                voiceBtn.style.display = 'none';
                voiceStatus.textContent = 'Reconhecimento de voz nÃ£o Ã© suportado neste navegador.';
            }
        }

        function checkVoiceAnswer(transcript) {
            const answerButtons = Array.from(answersContainer.children);
            let foundMatch = false;
            
            for (const button of answerButtons) {
                const buttonText = button.textContent.toLowerCase();
                // Tenta encontrar uma correspondÃªncia exata ou parcial
                if (transcript.includes(buttonText) || buttonText.includes(transcript)) {
                    button.click();
                    foundMatch = true;
                    break;
                }
            }

            if (!foundMatch) {
                voiceStatus.textContent = 'NÃ£o entendi. Clique ou tente falar de novo.';
            }
        }

        function resetVoiceButton() {
            voiceBtn.classList.remove('listening');
        }

        // --- FUNÃ‡Ã•ES DO JOGO ---
        function shuffleArray(array) { for (let i = array.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [array[i], array[j]] = [array[j], array[i]]; } }

        function startGame() {
            playerName = playerNameInput.value || "Jogador";
            questions = [...allQuestions];
            shuffleArray(questions);
            currentQuestionIndex = 0;
            score = 0;
            correctAnswersCount = 0;
            scoreText.innerText = `Pontos: 0`;
            correctAnswersText.innerText = `Acertos: 0`;
            showScreen('quiz');
            showQuestion();
        }

        function showQuestion() {
            resetState();
            progressText.innerText = `Pergunta ${currentQuestionIndex + 1} / ${questions.length}`;
            const currentQuestion = questions[currentQuestionIndex];
            questionText.innerText = currentQuestion.question;
            const btnColors = ['btn-color-1', 'btn-color-2', 'btn-color-3', 'btn-color-4'];
            currentQuestion.answers.forEach((answer, index) => {
                const button = document.createElement('button');
                button.innerText = answer.text;
                button.classList.add('answer-btn', btnColors[index % btnColors.length]);
                if (answer.correct) button.dataset.correct = true;
                button.addEventListener('click', selectAnswer);
                answersContainer.appendChild(button);
            });
        }
        
        function resetState() { 
            while (answersContainer.firstChild) { answersContainer.removeChild(answersContainer.firstChild); }
            voiceStatus.textContent = '';
            resetVoiceButton();
        }

        function selectAnswer(e) {
            const selectedButton = e.target;
            const correct = selectedButton.dataset.correct === 'true';

            if (correct) {
                correctAnswersCount++;
                score += 10;
                scoreText.innerText = `Pontos: ${score}`;
                correctAnswersText.innerText = `Acertos: ${correctAnswersCount}`;
                selectedButton.classList.add('correct');
            } else {
                selectedButton.classList.add('incorrect');
            }
            
            Array.from(answersContainer.children).forEach(button => {
                if (button.dataset.correct === 'true' && !correct) button.classList.add('correct');
                button.disabled = true;
            });
            
            voiceBtn.disabled = true; // Desabilita o botÃ£o de voz apÃ³s a resposta
            setTimeout(() => showExplanation(correct), 1500);
        }

        function showExplanation(isCorrect) {
            showScreen('explanation');
            const feedbackArray = isCorrect ? correctFeedbacks : incorrectFeedbacks;
            const randomIndex = Math.floor(Math.random() * feedbackArray.length);
            explanationHeader.innerText = feedbackArray[randomIndex];
            explanationHeader.style.color = isCorrect ? 'var(--success-color)' : 'var(--danger-color)';
            
            explanationText.innerText = questions[currentQuestionIndex].explanation;
        }

        function showNextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                showScreen('quiz');
                showQuestion();
                voiceBtn.disabled = false; // Reabilita o botÃ£o de voz
            } else {
                showResults();
            }
        }
        
        function showResults() {
            showScreen('results');
            finalPlayerName.innerText = playerName;
            const totalQuestions = questions.length;
            const maxScore = totalQuestions * 10;
            const percentage = (correctAnswersCount / totalQuestions) * 100;

            finalScoreText.innerText = `${score} / ${maxScore}`;
            finalCorrectAnswersText.innerText = `VocÃª acertou ${correctAnswersCount} de ${totalQuestions} perguntas.`;

            if (percentage === 100) {
                awardIcon.innerText = 'ðŸ¥‡';
                awardText.innerText = 'TrofÃ©u Heitor de Ouro';
            } else if (percentage >= 80) {
                awardIcon.innerText = 'ðŸ¥ˆ';
                awardText.innerText = 'TrofÃ©u Bibi dos CÃ£es de Prata';
            } else if (percentage >= 60) {
                awardIcon.innerText = 'ðŸ¥‰';
                awardText.innerText = 'TrofÃ©u Labubu de Bronze';
            } else {
                awardIcon.innerText = 'ðŸ—‘ï¸';
                awardText.innerText = 'ParabÃ©ns, seu lixo';
            }
        }

        function shareResult() {
            const textToCopy = `Consegui ${score} pontos no Quiz de CiÃªncias! Tente me superar! Para jogar, peÃ§a o arquivo "quiz.html" para o Heitor.`;
            const textArea = document.createElement('textarea');
            textArea.value = textToCopy;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);

            shareNotification.innerText = 'Mensagem copiada!';
            setTimeout(() => {
                shareNotification.innerText = '';
            }, 2000);
        }

        function restartGame() {
            showScreen('start');
            playerNameInput.value = "";
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            showScreen('start');
            setupSpeechRecognition();
        });

    </script>
</body>
</html>
